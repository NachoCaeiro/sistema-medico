<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ 'Editar' if patient else 'Agregar' }} Paciente</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header class="page-header">
        <h1>{{ 'Editar' if patient else 'Agregar Nuevo' }} Paciente</h1>
    </header>

    <div class="container">
        {% if error %}
            <p class="alert alert-danger">{{ error }}</p>
        {% endif %}

        <form method="post" action="{{ form_action_url }}">
            <div>
                <label for="name">Nombre:</label>
                <input type="text" id="name" name="name" value="{{ patient.name if patient else (patient_data.name if patient_data else '') }}" required placeholder="Ej: Juan">
            </div>
            <div>
                <label for="surname">Apellido:</label>
                <input type="text" id="surname" name="surname" value="{{ patient.surname if patient else (patient_data.surname if patient_data else '') }}" required placeholder="Ej: Pérez">
            </div>
            <div>
                <label for="document_number">Número de Documento:</label>
                <input type="text" id="document_number" name="document_number" value="{{ patient.document_number if patient else (patient_data.document_number if patient_data else '') }}" required placeholder="Ej: 12345678"
                pattern="\d+" title="Ingrese solo números" inputmode="numeric"
                oninput="this.value = this.value.replace(/[^0-9]/g, '')">
            </div>
            <div>
                <label for="phone">Teléfono:</label>
                <input type="text" id="phone" name="phone" value="{{ patient.phone if patient else (patient_data.phone if patient_data else '') }}" placeholder="Ej: +5491122334455">
            </div>
            <div>
                <label for="email">Correo Electrónico:</label>
                <input type="email" id="email" name="email" value="{{ patient.email if patient else (patient_data.email if patient_data else '') }}" placeholder="Ej: juan.perez@example.com">
            </div>
            <div>
                <label for="age">Edad:</label>
                <input type="number" id="age" name="age" value="{{ patient.age if patient else (patient_data.age if patient_data else '') }}" placeholder="Ej: 30">
            </div>
            <div>
                <label for="company_id">Empresa:</label>
                <select id="company_id" name="company_id" required>
                    <option value="">Seleccione una Empresa</option>
                    {% for company in companies %}
                        <option value="{{ company.id }}"
                                {% if patient and patient.company_id == company.id %}selected
                                {% elif patient_data and patient_data.company_id|int == company.id %}selected
                                {% endif %}>
                            {{ company.name }}
                        </option>
                    {% endfor %}
                </select>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button type="submit" class="btn">{{ 'Actualizar Paciente' if patient else 'Guardar Paciente' }}</button>
                <a href="{{ url_for('home') }}" class="btn btn-secondary">Volver al Tablero</a>
            </div>

        </form>
        <!--<p><a href="{{ url_for('home') }}" class="btn btn-secondary">Volver al Tablero</a></p>-->
    </div>
</body>
</html>
